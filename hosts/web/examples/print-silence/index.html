
<!DOCTYPE html>
<html>
    <head>
        <title>libflock wasm example</title>
    </head>

    <body>
        <div id="message"></div>

        <script type="module">
        (async() => {
            const response = await fetch('../../build/libflock.wasm');
            const bytes = await response.arrayBuffer();
            const { instance } = await WebAssembly.instantiate(bytes);

            let memoryOffset = instance.exports.flock_generate_silence();
            let bufferLength = 64; // TODO: How do we access the flock_BUFFER_SIZE constant defined in C?
            let buffer = new Float32Array(instance.exports.memory.buffer, memoryOffset, 64);

            let bufferString = ""
            for (let i = 0; i < buffer.length - 1; i++) {
                bufferString += buffer[i] + ", ";
            }
            bufferString += buffer[buffer.length - 1];

            document.querySelector("#message").innerHTML = "Enjoy the " + bufferString + ".";
        })();
        </script>
    </body>
</html>
